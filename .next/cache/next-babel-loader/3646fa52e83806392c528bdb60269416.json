{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\corde\\\\Desktop\\\\New folder\\\\bikeshop\\\\bikeshop_frontend\\\\components\\\\payments\\\\CreditCard.js\";\nvar __jsx = React.createElement;\nimport React, { useState } from \"react\";\n\nconst CreditCard = ({\n  amount,\n  description\n}) => {\n  const {\n    0: name,\n    1: setName\n  } = useState(\"\");\n  const {\n    0: phone,\n    1: setPhone\n  } = useState(\"\");\n  const {\n    0: email,\n    1: setEmail\n  } = useState(\"\");\n  const {\n    0: cardHolder,\n    1: setCardHolder\n  } = useState(\"\");\n  const {\n    0: number,\n    1: setNumber\n  } = useState(\"\");\n  const {\n    0: month,\n    1: setMonth\n  } = useState(\"\");\n  const {\n    0: year,\n    1: setYear\n  } = useState(\"\");\n  const {\n    0: code,\n    1: setCode\n  } = useState(\"\");\n  const {\n    0: paymentStatus,\n    1: setPaymentStatus\n  } = useState(\"\"); // Function to Listen to the Payment in the Front End\n\n  const listenToPayment = async fullClient => {\n    const paymentIntentId = fullClient.split(\"_client\")[0];\n    let i = 5;\n\n    for (let i = 5; i > 0; i--) {\n      setPaymentStatus(`Listening to Payment in ${i}`);\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      if (i == 1) {\n        const paymentIntentData = await fetch(\"https://api.paymongo.com/v1/payment_intents/\" + paymentIntentId + \"?client_key=\" + fullClient, {\n          headers: {\n            // Base64 encoded public PayMongo API key.\n            Authorization: `Basic ${Buffer.from(process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC).toString(\"base64\")}`\n          }\n        }).then(response => {\n          return response.json();\n        }).then(response => {\n          console.log(response.data);\n          return response.data;\n        });\n\n        if (paymentIntentData.attributes.last_payment_error) {\n          setPaymentStatus(JSON.stringify(paymentIntentData.attributes.last_payment_error));\n        } else if (paymentIntentData.attributes.status === \"succeeded\") {\n          setPaymentStatus(\"Payment Success\");\n        } else {\n          i = 5;\n        }\n      }\n    }\n  }; // Function to Create a Payment Intent by calling the site's api\n\n\n  const createPaymentIntent = async () => {\n    setPaymentStatus(\"Creating Payment Intent\");\n    const paymentIntent = await fetch(\"/api/createPaymentIntent\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        data: {\n          attributes: {\n            amount: amount * 100,\n            payment_method_allowed: [\"card\"],\n            payment_method_options: {\n              card: {\n                request_three_d_secure: \"any\"\n              }\n            },\n            currency: \"PHP\",\n            description: description,\n            statement_descriptor: \"descriptor business name\"\n          }\n        }\n      })\n    }).then(response => {\n      return response.json();\n    }).then(response => {\n      return response.body.data;\n    });\n    return paymentIntent;\n  }; // Function to Create a Payment Method by calling the PayMongo API\n\n\n  const createPaymentMethod = async () => {\n    setPaymentStatus(\"Creating Payment Method\");\n    const paymentMethod = fetch(\"https://api.paymongo.com/v1/payment_methods\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: `Basic ${Buffer.from(process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC).toString(\"base64\")}`\n      },\n      body: JSON.stringify({\n        data: {\n          attributes: {\n            details: {\n              card_number: `${number}`,\n              //\"4343434343434345\",\n              exp_month: parseInt(`${month}`),\n              //2\n              exp_year: parseInt(`${year}`),\n              //22\n              cvc: `${code}` //\"123\",\n\n            },\n            billing: {\n              name: `${name}`,\n              email: `${email}`,\n              phone: `${phone}`\n            },\n            type: \"card\"\n          }\n        }\n      })\n    }).then(response => {\n      return response.json();\n    }).then(response => {\n      return response.data;\n    }).catch(err => {\n      console.log(err);\n      setPaymentStatus(err);\n      return err;\n    });\n    return paymentMethod;\n  }; // Function to Attach a Payment Method to the Intent by calling the PayMongo API\n\n\n  const attachIntentMethod = async (intent, method) => {\n    setPaymentStatus(\"Attaching Intent to Method\");\n    fetch(`https://api.paymongo.com/v1/payment_intents/${intent.id}/attach`, {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: `Basic ${Buffer.from(process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC).toString(\"base64\")}`\n      },\n      body: JSON.stringify({\n        data: {\n          attributes: {\n            payment_method: `${method.id}`,\n            client_key: `${intent.attributes.client_key}`\n          }\n        }\n      })\n    }).then(response => response.json()).then(response => {\n      const paymentIntent = response.data;\n      console.log(paymentIntent);\n      const paymentIntentStatus = paymentIntent.attributes.status;\n\n      if (paymentIntentStatus === \"awaiting_next_action\") {\n        // Render your modal for 3D Secure Authentication since next_action has a value. You can access the next action via paymentIntent.attributes.next_action.\n        setPaymentStatus(paymentIntentStatus);\n        window.open(paymentIntent.attributes.next_action.redirect.url, \"_blank\");\n        listenToPayment(paymentIntent.attributes.client_key);\n      } else {\n        setPaymentStatus(paymentIntentStatus);\n      }\n    }).catch(err => {\n      console.log(err);\n      setPaymentStatus(JSON.stringify(err));\n    });\n  };\n\n  const onSubmit = async event => {\n    event.preventDefault();\n    const paymentIntent = await createPaymentIntent();\n    const paymentMethod = await createPaymentMethod();\n    await attachIntentMethod(paymentIntent, paymentMethod);\n  };\n\n  return __jsx(\"section\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 5\n    }\n  }, __jsx(\"form\", {\n    action: \"#\",\n    onSubmit: onSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }\n  }, __jsx(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }\n  }, \"Billing Information\"), __jsx(\"div\", {\n    id: \"form-card\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"customer-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 11\n    }\n  }, \"Customer Name:\"), __jsx(\"input\", {\n    id: \"customer-name\",\n    placeholder: \"Juan Dela Cruz\",\n    name: \"name\",\n    className: \"input\",\n    value: name,\n    onChange: e => setName(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    id: \"form-card\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"phone\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 11\n    }\n  }, \"Phone Number:\"), __jsx(\"input\", {\n    id: \"phone\",\n    placeholder: \"09xxxxxxxxx\",\n    name: \"phone\",\n    className: \"input\",\n    value: phone,\n    onChange: e => setPhone(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    id: \"form-card\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, \"email:\"), __jsx(\"input\", {\n    id: \"email\",\n    name: \"email\",\n    placeholder: \"user@domain.com\",\n    className: \"input\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  })), __jsx(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 9\n    }\n  }, \"Payment Details\"), __jsx(\"div\", {\n    id: \"form-card\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"cc-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 11\n    }\n  }, \"Card Holder:\"), __jsx(\"input\", {\n    id: \"cc-name\",\n    name: \"cc-name\",\n    placeholder: \"Juan Dela Cruz\",\n    className: \"input\",\n    value: cardHolder,\n    onChange: e => setCardHolder(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    id: \"form-card\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"cc-number\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 11\n    }\n  }, \"Card number:\"), __jsx(\"input\", {\n    id: \"cc-number\",\n    name: \"cc-number\",\n    maxLength: \"19\",\n    placeholder: \"1111 2222 3333 4444\",\n    className: \"input\",\n    value: number,\n    onChange: e => setNumber(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    id: \"form-date\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"expiry-month\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 11\n    }\n  }, \"Expiry date:\"), __jsx(\"div\", {\n    className: \"dateVal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 11\n    }\n  }, __jsx(\"select\", {\n    id: \"expiry-month\",\n    name: \"expiry-month\",\n    className: \"select\",\n    value: month,\n    onChange: e => setMonth(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    id: \"trans-label_month\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 15\n    }\n  }, \"Month\"), __jsx(\"option\", {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 15\n    }\n  }, \"01\"), __jsx(\"option\", {\n    value: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 15\n    }\n  }, \"02\"), __jsx(\"option\", {\n    value: \"3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 15\n    }\n  }, \"03\"), __jsx(\"option\", {\n    value: \"4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 15\n    }\n  }, \"04\"), __jsx(\"option\", {\n    value: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 15\n    }\n  }, \"05\"), __jsx(\"option\", {\n    value: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 15\n    }\n  }, \"06\"), __jsx(\"option\", {\n    value: \"7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 15\n    }\n  }, \"07\"), __jsx(\"option\", {\n    value: \"8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 15\n    }\n  }, \"08\"), __jsx(\"option\", {\n    value: \"9\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 15\n    }\n  }, \"09\"), __jsx(\"option\", {\n    value: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 15\n    }\n  }, \"10\"), __jsx(\"option\", {\n    value: \"11\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 15\n    }\n  }, \"11\"), __jsx(\"option\", {\n    value: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 15\n    }\n  }, \"12\")), __jsx(\"select\", {\n    id: \"expiry-year\",\n    name: \"expiry-year\",\n    className: \"select\",\n    value: year,\n    onChange: e => setYear(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    id: \"trans-label_year\",\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 15\n    }\n  }, \"Year\"), __jsx(\"option\", {\n    value: \"2021\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 15\n    }\n  }, \"21\"), __jsx(\"option\", {\n    value: \"2022\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 15\n    }\n  }, \"22\"), __jsx(\"option\", {\n    value: \"2023\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 15\n    }\n  }, \"23\"), __jsx(\"option\", {\n    value: \"2024\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 15\n    }\n  }, \"24\"), __jsx(\"option\", {\n    value: \"2025\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 15\n    }\n  }, \"25\"), __jsx(\"option\", {\n    value: \"2026\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 15\n    }\n  }, \"26\"), __jsx(\"option\", {\n    value: \"2027\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 15\n    }\n  }, \"27\"), __jsx(\"option\", {\n    value: \"2028\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 15\n    }\n  }, \"28\"), __jsx(\"option\", {\n    value: \"2029\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 15\n    }\n  }, \"29\"), __jsx(\"option\", {\n    value: \"2030\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 15\n    }\n  }, \"30\"), __jsx(\"option\", {\n    value: \"2031\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 15\n    }\n  }, \"31\"), __jsx(\"option\", {\n    value: \"2032\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 15\n    }\n  }, \"32\"), __jsx(\"option\", {\n    value: \"2033\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 15\n    }\n  }, \"33\"), __jsx(\"option\", {\n    value: \"2034\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 15\n    }\n  }, \"34\"), __jsx(\"option\", {\n    value: \"2035\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 15\n    }\n  }, \"35\"), __jsx(\"option\", {\n    value: \"2036\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 15\n    }\n  }, \"36\"), __jsx(\"option\", {\n    value: \"2037\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 15\n    }\n  }, \"37\"), __jsx(\"option\", {\n    value: \"2038\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 15\n    }\n  }, \"38\"), __jsx(\"option\", {\n    value: \"2039\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 15\n    }\n  }, \"39\"), __jsx(\"option\", {\n    value: \"2040\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 15\n    }\n  }, \"40\"), __jsx(\"option\", {\n    value: \"2041\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 15\n    }\n  }, \"41\"), __jsx(\"option\", {\n    value: \"2042\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 15\n    }\n  }, \"42\"), __jsx(\"option\", {\n    value: \"2043\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 15\n    }\n  }, \"43\"), __jsx(\"option\", {\n    value: \"2044\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 15\n    }\n  }, \"44\"), __jsx(\"option\", {\n    value: \"2045\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 15\n    }\n  }, \"45\"), __jsx(\"option\", {\n    value: \"2046\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 15\n    }\n  }, \"46\"), __jsx(\"option\", {\n    value: \"2047\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 15\n    }\n  }, \"47\")))), __jsx(\"div\", {\n    id: \"form-sec-code\",\n    className: \"formField\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 9\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"sec-code\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  }, \"Security code:\"), __jsx(\"input\", {\n    name: \"sec-code\",\n    type: \"password\",\n    maxLength: \"3\",\n    placeholder: \"123\",\n    className: \"input\",\n    value: code,\n    onChange: e => setCode(e.target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 11\n    }\n  })), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"payButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 9\n    }\n  }, \"Pay\"), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 9\n    }\n  }, paymentStatus)));\n};\n\nexport default CreditCard;","map":{"version":3,"sources":["C:/Users/corde/Desktop/New folder/bikeshop/bikeshop_frontend/components/payments/CreditCard.js"],"names":["React","useState","CreditCard","amount","description","name","setName","phone","setPhone","email","setEmail","cardHolder","setCardHolder","number","setNumber","month","setMonth","year","setYear","code","setCode","paymentStatus","setPaymentStatus","listenToPayment","fullClient","paymentIntentId","split","i","Promise","resolve","setTimeout","paymentIntentData","fetch","headers","Authorization","Buffer","from","process","env","NEXT_PUBLIC_PAYMONGO_PUBLIC","toString","then","response","json","console","log","data","attributes","last_payment_error","JSON","stringify","status","createPaymentIntent","paymentIntent","method","body","payment_method_allowed","payment_method_options","card","request_three_d_secure","currency","statement_descriptor","createPaymentMethod","paymentMethod","Accept","details","card_number","exp_month","parseInt","exp_year","cvc","billing","type","catch","err","attachIntentMethod","intent","id","payment_method","client_key","paymentIntentStatus","window","open","next_action","redirect","url","onSubmit","event","preventDefault","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\n\r\nconst CreditCard = ({ amount, description }) => {\r\n  const [name, setName] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n\r\n  const [cardHolder, setCardHolder] = useState(\"\");\r\n  const [number, setNumber] = useState(\"\");\r\n  const [month, setMonth] = useState(\"\");\r\n  const [year, setYear] = useState(\"\");\r\n  const [code, setCode] = useState(\"\");\r\n\r\n  const [paymentStatus, setPaymentStatus] = useState(\"\");\r\n\r\n  // Function to Listen to the Payment in the Front End\r\n  const listenToPayment = async (fullClient) => {\r\n    const paymentIntentId = fullClient.split(\"_client\")[0];\r\n    let i = 5;\r\n    for (let i = 5; i > 0; i--) {\r\n      setPaymentStatus(`Listening to Payment in ${i}`);\r\n      await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n      if (i == 1) {\r\n        const paymentIntentData = await fetch(\r\n          \"https://api.paymongo.com/v1/payment_intents/\" +\r\n            paymentIntentId +\r\n            \"?client_key=\" +\r\n            fullClient,\r\n          {\r\n            headers: {\r\n              // Base64 encoded public PayMongo API key.\r\n              Authorization: `Basic ${Buffer.from(\r\n                process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC\r\n              ).toString(\"base64\")}`,\r\n            },\r\n          }\r\n        )\r\n          .then((response) => {\r\n            return response.json();\r\n          })\r\n          .then((response) => {\r\n            console.log(response.data);\r\n            return response.data;\r\n          });\r\n\r\n        if (paymentIntentData.attributes.last_payment_error) {\r\n          setPaymentStatus(\r\n            JSON.stringify(paymentIntentData.attributes.last_payment_error)\r\n          );\r\n        } else if (paymentIntentData.attributes.status === \"succeeded\") {\r\n          setPaymentStatus(\"Payment Success\");\r\n        } else {\r\n          i = 5;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Function to Create a Payment Intent by calling the site's api\r\n  const createPaymentIntent = async () => {\r\n    setPaymentStatus(\"Creating Payment Intent\");\r\n    const paymentIntent = await fetch(\"/api/createPaymentIntent\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        data: {\r\n          attributes: {\r\n            amount: amount * 100,\r\n            payment_method_allowed: [\"card\"],\r\n            payment_method_options: {\r\n              card: { request_three_d_secure: \"any\" },\r\n            },\r\n            currency: \"PHP\",\r\n            description: description,\r\n            statement_descriptor: \"descriptor business name\",\r\n          },\r\n        },\r\n      }),\r\n    })\r\n      .then((response) => {\r\n        return response.json();\r\n      })\r\n      .then((response) => {\r\n        return response.body.data;\r\n      });\r\n\r\n    return paymentIntent;\r\n  };\r\n\r\n  // Function to Create a Payment Method by calling the PayMongo API\r\n  const createPaymentMethod = async () => {\r\n    setPaymentStatus(\"Creating Payment Method\");\r\n    const paymentMethod = fetch(\"https://api.paymongo.com/v1/payment_methods\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Basic ${Buffer.from(\r\n          process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC\r\n        ).toString(\"base64\")}`,\r\n      },\r\n      body: JSON.stringify({\r\n        data: {\r\n          attributes: {\r\n            details: {\r\n              card_number: `${number}`, //\"4343434343434345\",\r\n              exp_month: parseInt(`${month}`), //2\r\n              exp_year: parseInt(`${year}`), //22\r\n              cvc: `${code}`, //\"123\",\r\n            },\r\n            billing: {\r\n              name: `${name}`,\r\n              email: `${email}`,\r\n              phone: `${phone}`,\r\n            },\r\n            type: \"card\",\r\n          },\r\n        },\r\n      }),\r\n    })\r\n      .then((response) => {\r\n        return response.json();\r\n      })\r\n      .then((response) => {\r\n        return response.data;\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setPaymentStatus(err);\r\n        return err;\r\n      });\r\n\r\n    return paymentMethod;\r\n  };\r\n\r\n  // Function to Attach a Payment Method to the Intent by calling the PayMongo API\r\n  const attachIntentMethod = async (intent, method) => {\r\n    setPaymentStatus(\"Attaching Intent to Method\");\r\n    fetch(`https://api.paymongo.com/v1/payment_intents/${intent.id}/attach`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Basic ${Buffer.from(\r\n          process.env.NEXT_PUBLIC_PAYMONGO_PUBLIC\r\n        ).toString(\"base64\")}`,\r\n      },\r\n      body: JSON.stringify({\r\n        data: {\r\n          attributes: {\r\n            payment_method: `${method.id}`,\r\n            client_key: `${intent.attributes.client_key}`,\r\n          },\r\n        },\r\n      }),\r\n    })\r\n      .then((response) => response.json())\r\n      .then((response) => {\r\n        const paymentIntent = response.data;\r\n        console.log(paymentIntent);\r\n        const paymentIntentStatus = paymentIntent.attributes.status;\r\n        if (paymentIntentStatus === \"awaiting_next_action\") {\r\n          // Render your modal for 3D Secure Authentication since next_action has a value. You can access the next action via paymentIntent.attributes.next_action.\r\n          setPaymentStatus(paymentIntentStatus);\r\n          window.open(\r\n            paymentIntent.attributes.next_action.redirect.url,\r\n            \"_blank\"\r\n          );\r\n          listenToPayment(paymentIntent.attributes.client_key);\r\n        } else {\r\n          setPaymentStatus(paymentIntentStatus);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setPaymentStatus(JSON.stringify(err));\r\n      });\r\n  };\r\n\r\n  const onSubmit = async (event) => {\r\n    event.preventDefault();\r\n    const paymentIntent = await createPaymentIntent();\r\n    const paymentMethod = await createPaymentMethod();\r\n    await attachIntentMethod(paymentIntent, paymentMethod);\r\n  };\r\n\r\n  return (\r\n    <section>\r\n      <form action=\"#\" onSubmit={onSubmit}>\r\n        <h4>Billing Information</h4>\r\n        <div id=\"form-card\" className=\"formField\">\r\n          <label htmlFor=\"customer-name\">Customer Name:</label>\r\n          <input\r\n            id=\"customer-name\"\r\n            placeholder=\"Juan Dela Cruz\"\r\n            name=\"name\"\r\n            className={\"input\"}\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        <div id=\"form-card\" className={\"formField\"}>\r\n          <label htmlFor=\"phone\">Phone Number:</label>\r\n          <input\r\n            id=\"phone\"\r\n            placeholder=\"09xxxxxxxxx\"\r\n            name=\"phone\"\r\n            className={\"input\"}\r\n            value={phone}\r\n            onChange={(e) => setPhone(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        <div id=\"form-card\" className={\"formField\"}>\r\n          <label htmlFor=\"email\">email:</label>\r\n          <input\r\n            id=\"email\"\r\n            name=\"email\"\r\n            placeholder=\"user@domain.com\"\r\n            className={\"input\"}\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        <h4>Payment Details</h4>\r\n        <div id=\"form-card\" className={\"formField\"}>\r\n          <label htmlFor=\"cc-name\">Card Holder:</label>\r\n          <input\r\n            id=\"cc-name\"\r\n            name=\"cc-name\"\r\n            placeholder=\"Juan Dela Cruz\"\r\n            className={\"input\"}\r\n            value={cardHolder}\r\n            onChange={(e) => setCardHolder(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        <div id=\"form-card\" className={\"formField\"}>\r\n          <label htmlFor=\"cc-number\">Card number:</label>\r\n          <input\r\n            id=\"cc-number\"\r\n            name=\"cc-number\"\r\n            maxLength=\"19\"\r\n            placeholder=\"1111 2222 3333 4444\"\r\n            className={\"input\"}\r\n            value={number}\r\n            onChange={(e) => setNumber(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n\r\n        <div id=\"form-date\" className={\"formField\"}>\r\n          <label htmlFor=\"expiry-month\">Expiry date:</label>\r\n          <div className={\"dateVal\"}>\r\n            <select\r\n              id=\"expiry-month\"\r\n              name=\"expiry-month\"\r\n              className={\"select\"}\r\n              value={month}\r\n              onChange={(e) => setMonth(e.target.value)}\r\n              required\r\n            >\r\n              <option id=\"trans-label_month\">Month</option>\r\n              <option value=\"1\">01</option>\r\n              <option value=\"2\">02</option>\r\n              <option value=\"3\">03</option>\r\n              <option value=\"4\">04</option>\r\n              <option value=\"5\">05</option>\r\n              <option value=\"6\">06</option>\r\n              <option value=\"7\">07</option>\r\n              <option value=\"8\">08</option>\r\n              <option value=\"9\">09</option>\r\n              <option value=\"10\">10</option>\r\n              <option value=\"11\">11</option>\r\n              <option value=\"12\">12</option>\r\n            </select>\r\n            <select\r\n              id=\"expiry-year\"\r\n              name=\"expiry-year\"\r\n              className={\"select\"}\r\n              value={year}\r\n              onChange={(e) => setYear(e.target.value)}\r\n              required\r\n            >\r\n              <option id=\"trans-label_year\" value=\"\">\r\n                Year\r\n              </option>\r\n              <option value=\"2021\">21</option>\r\n              <option value=\"2022\">22</option>\r\n              <option value=\"2023\">23</option>\r\n              <option value=\"2024\">24</option>\r\n              <option value=\"2025\">25</option>\r\n              <option value=\"2026\">26</option>\r\n              <option value=\"2027\">27</option>\r\n              <option value=\"2028\">28</option>\r\n              <option value=\"2029\">29</option>\r\n              <option value=\"2030\">30</option>\r\n              <option value=\"2031\">31</option>\r\n              <option value=\"2032\">32</option>\r\n              <option value=\"2033\">33</option>\r\n              <option value=\"2034\">34</option>\r\n              <option value=\"2035\">35</option>\r\n              <option value=\"2036\">36</option>\r\n              <option value=\"2037\">37</option>\r\n              <option value=\"2038\">38</option>\r\n              <option value=\"2039\">39</option>\r\n              <option value=\"2040\">40</option>\r\n              <option value=\"2041\">41</option>\r\n              <option value=\"2042\">42</option>\r\n              <option value=\"2043\">43</option>\r\n              <option value=\"2044\">44</option>\r\n              <option value=\"2045\">45</option>\r\n              <option value=\"2046\">46</option>\r\n              <option value=\"2047\">47</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"form-sec-code\" className={\"formField\"}>\r\n          <label htmlFor=\"sec-code\">Security code:</label>\r\n          <input\r\n            name=\"sec-code\"\r\n            type=\"password\"\r\n            maxLength=\"3\"\r\n            placeholder=\"123\"\r\n            className={\"input\"}\r\n            value={code}\r\n            onChange={(e) => setCode(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n\r\n        <button type=\"submit\" className={\"payButton\"}>\r\n          Pay\r\n        </button>\r\n        <p>{paymentStatus}</p>\r\n      </form>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default CreditCard;\r\n"]},"metadata":{},"sourceType":"module"}