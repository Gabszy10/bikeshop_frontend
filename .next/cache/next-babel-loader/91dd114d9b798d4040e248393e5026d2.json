{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport cookie from \"js-cookie\";\nimport axios from \"axios\";\nimport { formatNumber } from \"../../helpers/function\";\nimport { decryptInfoData, encryptInfoData } from \"../../store/actions/infoActions\";\nvar host = process.env.API_URL;\n\nfunction Profile() {\n  var _useState = useState([]),\n      history = _useState[0],\n      sethistory = _useState[1];\n\n  var _useState2 = useState(null),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      orderDetails = _useState3[0],\n      setorderDetails = _useState3[1];\n\n  useEffect(function () {\n    var token = cookie.get(\"_wus_BJK\");\n\n    if (!token) {// window.location.href = \"/\";\n    } else {\n      fetchOrders(token);\n      fetchUserInfo(token);\n    }\n  }, []);\n\n  var fetchUserInfo = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(token) {\n      var res, decryptedData, newData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get(\"\".concat(host, \"/api/user/user/details\"), {\n                headers: {\n                  Authorization: \"\".concat(token)\n                }\n              });\n\n            case 3:\n              res = _context.sent;\n\n              if (res) {\n                setUser(res.data.userDetails);\n                decryptedData = decryptInfoData();\n                console.log(decryptedData);\n                newData = _objectSpread(_objectSpread({}, decryptedData), {}, {\n                  shipping_firstName: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  shipping_lastName: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  shipping_address: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  shipping_city: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  shipping_zip: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  billing_email: {\n                    value: res.data.userDetails.email || \"\",\n                    error: \"\"\n                  },\n                  shipping_phone: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  billing_firstName: {\n                    value: res.data.userDetails.first_name || \"\",\n                    error: \"\"\n                  },\n                  billing_lastName: {\n                    value: res.data.userDetails.last_name || \"\",\n                    error: \"\"\n                  },\n                  billing_phone: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  note: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  message: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  delivery_date: {\n                    value: \"\",\n                    error: \"\"\n                  },\n                  delivery_time: {\n                    value: \"\",\n                    error: \"\"\n                  }\n                });\n                console.log(newData);\n                encryptInfoData(newData);\n              }\n\n              console.log(res);\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n\n              if (_context.t0.response.status == 401) {\n                cookie.remove(\"_wus_BJK\");\n                window.location.href = \"/\";\n              }\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 8]]);\n    }));\n\n    return function fetchUserInfo(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fetchOrders = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(token) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axios.get(\"\".concat(host, \"/api/user/order/history\"), {\n                headers: {\n                  Authorization: \"\".concat(token)\n                }\n              });\n\n            case 3:\n              res = _context2.sent;\n\n              if (res) {\n                sethistory(res.data.orders);\n              }\n\n              console.log(res);\n              _context2.next = 12;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n\n              if (_context2.t0.response.status == 401) {\n                cookie.remove(\"_wus_BJK\");\n                window.location.href = \"/\";\n              }\n\n              if (_context2.t0.response.data.err == \"user order history not found\") {\n                sethistory([]);\n              }\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n\n    return function fetchOrders(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleDetails = function handleDetails() {};\n\n  return __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-4\"\n  }, __jsx(\"div\", {\n    className: \"card\",\n    style: {\n      marginLeft: \"1.7rem\"\n    }\n  }, __jsx(\"div\", {\n    className: \"card-body m-auto text-center\"\n  }, __jsx(\"img\", {\n    src: \"https://t3.ftcdn.net/jpg/03/39/45/96/360_F_339459697_XAFacNQmwnvJRqe1Fe9VOptPWMUxlZP8.jpg\",\n    alt: \"\",\n    height: \"100\",\n    style: {\n      borderRadius: \"50%\",\n      marginBottom: \"1rem\"\n    }\n  }), __jsx(\"h5\", {\n    className: \"card-title\"\n  }, user ? user.first_name : \"N/A\", \" \", user ? user.last_name : \"N/A\")))), history.length ? __jsx(\"div\", {\n    className: \"col-md-8\"\n  }, history.map(function (order, i) {\n    return __jsx(React.Fragment, null, __jsx(\"div\", {\n      key: i,\n      \"class\": \"card\"\n    }, __jsx(\"div\", {\n      className: \"card-header\"\n    }, __jsx(\"h5\", null, order.order_name), __jsx(\"p\", null, order.created_at)), __jsx(\"div\", {\n      className: \"card-body\"\n    }, __jsx(\"div\", {\n      className: \"row\"\n    }, __jsx(\"div\", {\n      className: \"col-md-4\"\n    }, __jsx(\"p\", {\n      className: \"card-text\"\n    }, \"Items:\"), order.order_items.map(function (item) {\n      return __jsx(\"p\", {\n        key: item.product_id,\n        className: \"card-text\"\n      }, item.product.name, \" - \", item.quantity, \"x\");\n    })), __jsx(\"div\", {\n      className: \"col-md-4\"\n    }, __jsx(\"p\", {\n      className: \"card-text\"\n    }, \"Mode Of Payment: \", order.payment_method), __jsx(\"p\", {\n      className: \"card-text\"\n    }, \"Payment Status: \", order.payment_status.name)), __jsx(\"div\", {\n      className: \"col-md-4\"\n    }, __jsx(\"p\", {\n      className: \"card-text\"\n    }, \"Order Status: \", order.order_status.name), __jsx(\"p\", {\n      className: \"card-text\"\n    }, \"Amount: P\", formatNumber(order.total)))))), __jsx(\"hr\", null));\n  })) : __jsx(\"h2\", {\n    className: \"text-center m-auto\"\n  }, \"Order history is empty.\"), __jsx(\"div\", {\n    className: \"modal fade\",\n    id: \"exampleModal\",\n    tabIndex: \"-1\",\n    role: \"dialog\",\n    \"aria-labelledby\": \"exampleModalLabel\",\n    \"aria-hidden\": \"true\"\n  }, __jsx(\"div\", {\n    className: \"modal-dialog\",\n    role: \"document\"\n  }, __jsx(\"div\", {\n    className: \"modal-content\"\n  }, __jsx(\"div\", {\n    className: \"modal-header\"\n  }, __jsx(\"h5\", {\n    className: \"modal-title\",\n    id: \"exampleModalLabel\"\n  }, \"Modal title\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"close\",\n    \"data-d\": \"modal\",\n    \"aria-label\": \"Close\"\n  }, __jsx(\"span\", {\n    \"aria-hidden\": \"true\"\n  }, \"\\xD7\"))), __jsx(\"div\", {\n    className: \"modal-body\"\n  }, \"...\"), __jsx(\"div\", {\n    className: \"modal-footer\"\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary\",\n    \"data-dismiss\": \"modal\"\n  }, \"Close\"), __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary\"\n  }, \"Save changes\"))))));\n}\n\nexport default Profile;","map":null,"metadata":{},"sourceType":"module"}