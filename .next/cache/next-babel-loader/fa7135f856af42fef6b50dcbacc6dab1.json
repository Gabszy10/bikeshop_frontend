{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport { connect } from \"react-redux\";\nimport OrderSummary from \"./OrderSummary\";\nimport Payment from \"../payments/Payment\";\nimport useForm from \"./userForm\";\nimport Calendar from \"../calendar/Calendar\";\nimport axios from \"axios\";\nimport { ToastContainer, toast, Zoom } from \"react-toastify\";\nimport { encryptInfoData } from \"../../store/actions/infoActions\";\nimport { isDateBeforeToday } from \"../../helpers/function\";\nimport { clearData } from \"../../store/actions/cartActions\";\n\nfunction CheckoutForm(_ref) {\n  var total = _ref.total,\n      shipping = _ref.shipping;\n  var host = process.env.API_URL;\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var cart, order, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"Form submitted.\");\n              cart = JSON.parse(localStorage.getItem(process.env.CART_COOKIE));\n              console.log(state, cart);\n              order = {\n                orderItems: cart,\n                shippingFirstName: stateSchema.shipping_firstName.value,\n                shippingLastName: stateSchema.shipping_lastName.value,\n                shippingPhone: stateSchema.shipping_phone.value,\n                shippingAddress: stateSchema.shipping_address.value,\n                shippingCity: stateSchema.shipping_city.value,\n                shippingProvince: \"Metro Manila\",\n                shippingZip: stateSchema.shipping_zip.value,\n                deliveryInstructions: stateSchema.note.value,\n                billingFirstName: stateSchema.billing_firstName.value,\n                billingLastName: stateSchema.billing_lastName.value,\n                billingPhone: stateSchema.billing_phone.value,\n                billingEmail: stateSchema.billing_email.value,\n                deliveryDate: stateSchema.delivery_date.value,\n                deliveryTime: \"Anytime\",\n                paymentMethod: \"COD\"\n              };\n              _context.prev = 4;\n              _context.next = 7;\n              return axios.post(\"\".concat(host, \"/api/user/order\"), order);\n\n            case 7:\n              res = _context.sent;\n\n              if (res) {\n                clearData();\n                window.location.href = \"/thankyou\";\n                console.log(res, \"RES\");\n              }\n\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](4);\n              console.log(_context.t0.response);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 11]]);\n    }));\n\n    return function handleSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var totalAmount = (total + shipping).toFixed(2);\n\n  var _useState = useState({\n    shipping_firstName: {\n      value: \"\",\n      error: \"\"\n    },\n    shipping_lastName: {\n      value: \"\",\n      error: \"\"\n    },\n    shipping_address: {\n      value: \"\",\n      error: \"\"\n    },\n    shipping_city: {\n      value: \"\",\n      error: \"\"\n    },\n    shipping_zip: {\n      value: \"\",\n      error: \"\"\n    },\n    billing_email: {\n      value: \"\",\n      error: \"\"\n    },\n    shipping_phone: {\n      value: \"\",\n      error: \"\"\n    },\n    billing_firstName: {\n      value: \"\",\n      error: \"\"\n    },\n    billing_lastName: {\n      value: \"\",\n      error: \"\"\n    },\n    billing_phone: {\n      value: \"\",\n      error: \"\"\n    },\n    note: {\n      value: \"\",\n      error: \"\"\n    },\n    message: {\n      value: \"\",\n      error: \"\"\n    },\n    delivery_date: {\n      value: \"\",\n      error: \"\"\n    },\n    delivery_time: {\n      value: \"\",\n      error: \"\"\n    }\n  }),\n      stateSchema = _useState[0],\n      setstateSchema = _useState[1];\n\n  var handleStateChange = function handleStateChange(e) {\n    setstateSchema(_objectSpread(_objectSpread({}, stateSchema), {}, _defineProperty({}, e.target.name, {\n      value: e.target.value,\n      error: \"\"\n    })));\n  };\n\n  var handleToast = function handleToast(message) {\n    toast.error(message, {\n      position: \"bottom-left\",\n      autoClose: 2000,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true\n    });\n  };\n\n  var isValid = function isValid() {\n    if (!state.shipping_lastName.value) {\n      handleToast(\"Please input receiver last name.\");\n      return false;\n    } else if (!state.shipping_firstName.value) {\n      handleToast(\"Please input receiver first name.\");\n      return false;\n    } else if (!state.shipping_address.value) {\n      handleToast(\"Please input receiver address.\");\n      return false;\n    } else if (!state.shipping_city.value) {\n      handleToast(\"Please input receiver city.\");\n      return false;\n    } else if (!state.shipping_zip.value) {\n      handleToast(\"Please input receiver zip.\");\n      return false;\n    } else if (!state.billing_email.value) {\n      handleToast(\"Please input your email info.\");\n      return false;\n    } else if (!state.shipping_phone.value) {\n      handleToast(\"Please input receiver contact number.\");\n      return false;\n    } else if (!state.billing_phone.value) {\n      handleToast(\"Please input your contact number.\");\n      return false;\n    } else if (!state.billing_firstName.value) {\n      handleToast(\"Please input your first name.\");\n      return false;\n    } else if (!state.billing_lastName.value) {\n      handleToast(\"Please input your last name.\");\n      return false;\n    } else if (!state.shipping_address.value) {\n      handleToast(\"Please input receiver address.\");\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  var validationStateSchema = {\n    shipping_firstName: {\n      required: true,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid first name format\"\n      }\n    },\n    delivery_date: {\n      required: true\n    },\n    delivery_time: {\n      required: true\n    },\n    shipping_lastName: {\n      required: true,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid last name format.\"\n      }\n    },\n    shipping_address: {\n      required: true,\n      validator: {\n        error: \"Invalid address format.\"\n      }\n    },\n    shipping_city: {\n      required: true,\n      validator: {\n        error: \"Invalid last name format.\"\n      }\n    },\n    shipping_zip: {\n      required: true,\n      validator: {\n        regEx: /^\\d{4}$|^\\d{4}-\\d{4}$/,\n        error: \"Invalid zip format, use like 1234.\"\n      }\n    },\n    billing_email: {\n      required: true,\n      validator: {\n        regEx: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,\n        error: \"Invalid email format, use like example@gmail.com\"\n      }\n    },\n    shipping_phone: {\n      required: true,\n      validator: {\n        regEx: /^0(9|4)\\d{9}$/,\n        error: \"Invalid phone number format use like 09343243243.\"\n      }\n    },\n    billing_firstName: {\n      required: true,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid first name format.\"\n      }\n    },\n    billing_lastName: {\n      required: true,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid last name format.\"\n      }\n    },\n    billing_phone: {\n      required: true,\n      validator: {\n        regEx: /^0(9|4)\\d{9}$/,\n        error: \"Invalid phone number format use like 09343243243.\"\n      }\n    },\n    note: {\n      required: false,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid note format.\"\n      }\n    },\n    message: {\n      required: false,\n      validator: {\n        regEx: /^[a-zA-Z]+$/,\n        error: \"Invalid message format.\"\n      }\n    }\n  };\n\n  var _useForm = useForm(stateSchema, validationStateSchema, handleSubmit, handleStateChange),\n      state = _useForm.state,\n      handleOnChange = _useForm.handleOnChange,\n      handleOnSubmit = _useForm.handleOnSubmit,\n      disable = _useForm.disable;\n\n  var errorStyle = {\n    color: \"red\",\n    fontSize: \"13px\"\n  }; // console.log(state);\n\n  var proceedToPayment = function proceedToPayment() {\n    if (isValid()) {\n      console.log(state);\n\n      if (encryptInfoData(state)) {\n        Router.push(\"/payment\");\n      }\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(ToastContainer, {\n    transition: Zoom\n  }), __jsx(\"section\", {\n    className: \"checkout-area ptb-60\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"form\", {\n    onSubmit: handleOnSubmit\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"shipping-details\"\n  }, __jsx(\"h3\", {\n    className: \"title\"\n  }, \"Send my orders to\"), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"First Name \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"shipping_firstName\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.shipping_firstName.value,\n    required: true\n  }), state.shipping_firstName.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_firstName.error))), __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Last Name \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"shipping_lastName\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.shipping_lastName.value,\n    required: true\n  }), state.shipping_lastName.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_lastName.error))), __jsx(\"div\", {\n    className: \"col-lg-12 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Phone\"), __jsx(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"shipping_phone\",\n    onChange: handleOnChange,\n    value: state.shipping_phone.value,\n    required: true\n  }), state.shipping_phone.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_phone.error))), __jsx(\"div\", {\n    className: \"col-lg-12 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Address \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"shipping_address\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.shipping_address.value,\n    placeholder: \"Street address, House Number / Company name, Baranggay\",\n    required: true\n  }), state.shipping_address.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_address.error))), __jsx(\"div\", {\n    className: \"col-lg-12 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Town / City \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"shipping_city\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.shipping_city.value,\n    required: true\n  }), state.shipping_city.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_city.error))), __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Postcode / Zip \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"shipping_zip\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.shipping_zip.value,\n    required: true\n  }), state.shipping_zip.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.shipping_zip.error))))), __jsx(\"hr\", {\n    className: \"dividerClass\"\n  }), __jsx(\"div\", {\n    className: \"billing-details\"\n  }, __jsx(\"h3\", {\n    className: \"title\"\n  }, \"Your Info\"), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"First Name \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"billing_firstName\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.billing_firstName.value,\n    placeholder: \"Your Firstname\",\n    required: true\n  }), state.billing_firstName.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.billing_firstName.error))), __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Last Name \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"text\",\n    name: \"billing_lastName\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.billing_lastName.value,\n    placeholder: \"Your Lastname\",\n    required: true\n  }), state.billing_lastName.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.billing_lastName.error))), __jsx(\"div\", {\n    className: \"col-lg-12 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Email Address \", __jsx(\"span\", {\n    className: \"required\"\n  }, \"*\")), __jsx(\"input\", {\n    type: \"email\",\n    name: \"billing_email\",\n    className: \"form-control\",\n    onChange: handleOnChange,\n    value: state.billing_email.value,\n    placeholder: \"Your email (For Order Confirmation)\",\n    required: true\n  }), state.billing_email.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.billing_email.error))), __jsx(\"div\", {\n    className: \"col-lg-12 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Phone\"), __jsx(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"billing_phone\",\n    onChange: handleOnChange,\n    value: state.billing_phone.value,\n    required: true\n  }), state.billing_phone.error && __jsx(\"p\", {\n    style: errorStyle\n  }, state.billing_phone.error)))))), __jsx(\"hr\", {\n    className: \"my-3 dividerClass\"\n  }), __jsx(\"div\", {\n    className: \"col-lg-6 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"order-details\"\n  }, __jsx(\"h3\", {\n    className: \"title\"\n  }, \"Your Order\"), __jsx(OrderSummary, null), __jsx(\"div\", {\n    className: \"order-btn\",\n    style: {\n      textAlign: \"center\",\n      paddingTop: \"20px\"\n    }\n  }, __jsx(\"button\", {\n    className: \"btn btn-light\",\n    style: {\n      width: \"90%\"\n    },\n    onClick: proceedToPayment\n  }, \"Proceed to Payment\")))))))));\n}\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    total: state.total,\n    shipping: state.shipping\n  };\n};\n\nexport default connect(mapStateToProps)(CheckoutForm);","map":null,"metadata":{},"sourceType":"module"}